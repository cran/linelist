<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>An introduction to linelist</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">An introduction to linelist</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(linelist)</a></code></pre></div>
<div id="motivations" class="section level1">
<h1>Motivations</h1>
<p>Outbreak analytics pipelines often start with <em>case line lists</em>, which are data tables in which every line is a different case/patient, and columns record different variables of potential epidemiological interest such as date of events (e.g. onset of symptom, case notification), disease outcome, or patient data (e.g. age, sex, occupation). Such data is typically held in a <code>data.frame</code> (or a <code>tibble</code>) and used in various downstream analysis. While this approach is functional, it often means that each analysis step will:</p>
<ol style="list-style-type: decimal">
<li><p>need to check the required inputs are present in the data, and for the user to specify where (e.g. ‘<em>This is the column where dates of onset are stored.</em>’)</p></li>
<li><p>need to validate the required data (e.g. ‘<em>Check that the field storing dates of onset are indeed dates, and not a <code>character</code>.</em>’)</p></li>
</ol>
<p>The aim of <em>linelist</em> is to take care of these pre-requisites once and for all before downstream analyses, thus helping to make data pipelines more robust and straightforward.</p>
</div>
<div id="linelist-in-a-nutshell" class="section level1">
<h1>linelist in a nutshell</h1>
<div id="outline" class="section level2">
<h2>Outline</h2>
<p><em>linelist</em> is an R package which implements basic data representation for case line lists, alongside accessors and basic methods. It essentially provides three types of functionalities:</p>
<ol style="list-style-type: decimal">
<li><p><strong>tagging</strong>: a <em>tags</em> system permits to pre-identify key epidemiological variables needed in downstream analyses (e.g. dates of case notification, symptom onset, age, gender, disease outcome)</p></li>
<li><p><strong>validation</strong>: functions checking that tagged variables are indeed present in the <code>data.frame/tibble</code>, and that they have the expected type (e.g. checking that dates are <code>Date</code>, <code>integer</code> or <code>numeric</code>)</p></li>
<li><p><strong>secured methods</strong>: generic functions which could lead to the loss of tagged variables have dedicated methods for <em>linelist</em> objects with adapted behaviours, either updating tags as needed (<em>e.g.</em> <code>rename</code>, <code>names() &lt;- ...</code>) or issuing warnings/errors when tagged variables are lost (<em>e.g.</em> <code>select</code>, <code>x[]</code>, <code>x[[]]</code>)</p></li>
</ol>
</div>
<div id="should-i-use-linelist" class="section level2">
<h2>Should I use <em>linelist</em>?</h2>
<p><em>linelist</em> is designed to add a robust, foundational layer to your data pipelines, but it might add unnecessary complexity to your analysis scripts. Here are a few hints to gauge if you should consider using the package.</p>
<p><strong>You may have use for <em>linelist</em> if …</strong>:</p>
<ul>
<li><p>your data changes/updates over time (e.g. new entries, new variables, renamed variables)</p></li>
<li><p>you build data pipelines entailing multiple layers of data processing and analysis</p></li>
<li><p>you are looking to build re-useable analysis scripts, <em>i.e.</em> which will work on other datasets with minimal added changes</p></li>
</ul>
<p><strong>Conversely, you probably do not need it if …</strong>:</p>
<ul>
<li><p>you work on historical data, which has likely already been curated/validated and will no longer change</p></li>
<li><p>you perform some quick, simple analysis of your data, which you will not need to expand on later</p></li>
<li><p>your analysis scripts are very specific and will not be re-used elsewhere</p></li>
</ul>
</div>
</div>
<div id="getting-started" class="section level1">
<h1>Getting started</h1>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>Our stable versions are released periodically on CRAN, and can be installed using:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;linelist&quot;</span>, <span class="dt">build_vignettes =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>If you prefer using the latest features and bug fixes, you can alternatively install the development version of <em>linelist</em> from <a href="https://github.com/">GitHub</a> using the following commands:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(remotes)) {</a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="kw">install.packages</span>(<span class="st">&quot;remotes&quot;</span>)</a>
<a class="sourceLine" id="cb3-3" title="3">}</a>
<a class="sourceLine" id="cb3-4" title="4">remotes<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;epiverse-trace/linelist&quot;</span>, <span class="dt">build_vignettes =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>Once installed, you can load the package in your R session using:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">library</span>(linelist)</a></code></pre></div>
</div>
<div id="key-functionalities" class="section level2">
<h2>Key functionalities</h2>
<p>A <code>linelist</code> object is an instance of a <code>data.frame</code> or a <code>tibble</code> in which key epidemiological variables have been <em>tagged</em>. The main features of the packages are broken down into the 3 categories outlined above.</p>
<div id="tagging-system" class="section level3">
<h3>Tagging system</h3>
<p>Tags are paired keys pointing a reference epidemiological variables to the name of a column in a <code>data.frame</code> or <code>tibble</code>. The tagging system permits to construct <code>linelist</code> objects, modify tags in existing objects, check and access existing tags and the corresponding variables.</p>
<ul>
<li><p><code>make_linelist()</code>: to create a <code>linelist</code> object by tagging key epi variables in a <code>data.frame</code> or a <code>tibble</code></p></li>
<li><p><code>set_tags():</code> to add, remove, or modify tags in a <code>linelist</code></p></li>
<li><p><code>tags()</code>: to list variables which have been tagged in a <code>linelist</code></p></li>
<li><p><code>tags_names()</code>: to list all recognized tag names; details on what the tags represent can be found at <a href="https://epiverse-trace.github.io/linelist/reference/make_linelist.html"><code>?make_linelist</code></a></p></li>
<li><p><code>select_tags():</code> to select columns of a <code>linelist</code> based on tags using <em>dplyr</em> compatible syntax</p></li>
<li><p><code>tags_df()</code>: to obtain a <code>data.frame</code> of all the tagged variables in a <code>linelist</code></p></li>
</ul>
</div>
<div id="validation" class="section level3">
<h3>Validation</h3>
<p>Basic routines are provided to validate <em>linelist</em> objects. More advanced validation e.g. looking at compatibility of dated events will be implemented in a separate package.</p>
<ul>
<li><p><code>validate_tags()</code>: check that tagged variables are present in the dataset, that tags match the pre-defined list of tagged variables</p></li>
<li><p><code>validate_types()</code>: check that tagged variables have an acceptable class, as defined in <code>tags_types()</code></p></li>
<li><p><code>validate_linelist()</code>: general validation of <em>linelist</em> objects, equivalent to running both <code>validate_tags()</code> and <code>validate_types()</code>, and checking the class of the object</p></li>
</ul>
</div>
<div id="secured-methods" class="section level3">
<h3>Secured methods</h3>
<p>These are dedicated S3 methods for existing generics which can be used to prevent the loss of tagged variables.</p>
<ul>
<li><p><code>lost_tags_actions()</code>: to set the behaviour to adopt when tagged variables would be lost by an operation: issue a warning (default), an error, or ignore</p></li>
<li><p><code>get_lost_tags_actions()</code>: to check the current behaviour for lost tagged variables</p></li>
<li><p><code>rename</code>: adapted from <code>dplyr::rename</code>, to rename columns of a <code>linelist</code>; will rename tags as needed to match the new column names</p></li>
<li><p><code>names(x) &lt;-</code>: same as <code>rename</code>, but using the ‘base R’ approach to renaming columns</p></li>
<li><p><code>select()</code>: adapted from <code>dplyr::select</code>, for subsetting columns; an additional argument can be used to subset tagged variables as well; will behave according to <code>get_lost_tags_actions()</code> if tagged variables are lost</p></li>
<li><p><code>x[]</code> and <code>x[[]]</code>: same as <code>dplyr::select</code> but using ‘base R’ syntax; will behave according to <code>get_lost_tags_actions()</code> if tagged variables are lost</p></li>
</ul>
</div>
</div>
</div>
<div id="worked-example" class="section level1">
<h1>Worked example</h1>
<div id="example-dataset" class="section level2">
<h2>Example dataset</h2>
<p>In this example, we use the case line list of the Hagelloch 1861 measles outbreak, distributed by the <em>outbreaks</em> pacakge as <code>measles_hagelloch_1861</code> .</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co"># load libraries</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="kw">library</span>(outbreaks)</a>
<a class="sourceLine" id="cb5-4" title="4"></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co"># overview of the data</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="kw">head</span>(measles_hagelloch_<span class="dv">1861</span>)</a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">#&gt;   case_ID infector date_of_prodrome date_of_rash date_of_death age gender</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">#&gt; 1       1       45       1861-11-21   1861-11-25          &lt;NA&gt;   7      f</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">#&gt; 2       2       45       1861-11-23   1861-11-27          &lt;NA&gt;   6      f</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#&gt; 3       3      172       1861-11-28   1861-12-02          &lt;NA&gt;   4      f</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co">#&gt; 4       4      180       1861-11-27   1861-11-28          &lt;NA&gt;  13      m</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co">#&gt; 5       5       45       1861-11-22   1861-11-27          &lt;NA&gt;   8      f</span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="co">#&gt; 6       6      180       1861-11-26   1861-11-29          &lt;NA&gt;  12      m</span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co">#&gt;   family_ID class complications x_loc y_loc</span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co">#&gt; 1        41     1           yes 142.5 100.0</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="co">#&gt; 2        41     1           yes 142.5 100.0</span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="co">#&gt; 3        41     0           yes 142.5 100.0</span></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="co">#&gt; 4        61     2           yes 165.0 102.5</span></a>
<a class="sourceLine" id="cb5-19" title="19"><span class="co">#&gt; 5        42     1           yes 145.0 120.0</span></a>
<a class="sourceLine" id="cb5-20" title="20"><span class="co">#&gt; 6        42     2           yes 145.0 120.0</span></a></code></pre></div>
</div>
<div id="creating-a-linelist-object" class="section level2">
<h2>Creating a <em>linelist</em> object</h2>
<p>Let us assume we want to tag the following variables to facilitate downstream analyses, after having checked their tag name in <code>?make_linelist</code>:</p>
<ul>
<li>the date of symptom onset, here called <code>prodrome</code> (tag: <code>date_onset</code>)</li>
<li>the date of death (tag: <code>date_death</code>)</li>
<li>the age of the patient (tag: <code>age</code>)</li>
<li>the gender of the patient (tag: <code>gender</code>)</li>
</ul>
<p>We first load a few useful packages, and create a <code>linelist</code> with the above information:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">library</span>(tibble) <span class="co"># data.frame but with nice printing </span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw">library</span>(dplyr) <span class="co"># for data handling</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">#&gt; Attaching package: &#39;dplyr&#39;</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#&gt; The following objects are masked from &#39;package:stats&#39;:</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt;     filter, lag</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt; The following objects are masked from &#39;package:base&#39;:</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">#&gt;     intersect, setdiff, setequal, union</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="kw">library</span>(magrittr) <span class="co"># for the %&gt;% operator</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="kw">library</span>(linelist) <span class="co"># this package!</span></a>
<a class="sourceLine" id="cb6-14" title="14"></a>
<a class="sourceLine" id="cb6-15" title="15">x &lt;-<span class="st"> </span>measles_hagelloch_<span class="dv">1861</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="st">  </span><span class="kw">tibble</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-17" title="17"><span class="st">  </span><span class="kw">make_linelist</span>(<span class="dt">date_onset =</span> <span class="st">&quot;date_of_prodrome&quot;</span>,</a>
<a class="sourceLine" id="cb6-18" title="18">                <span class="dt">date_death =</span> <span class="st">&quot;date_of_death&quot;</span>,</a>
<a class="sourceLine" id="cb6-19" title="19">                <span class="dt">age =</span> <span class="st">&quot;age&quot;</span>,</a>
<a class="sourceLine" id="cb6-20" title="20">                <span class="dt">gender =</span> <span class="st">&quot;gender&quot;</span>)</a>
<a class="sourceLine" id="cb6-21" title="21">x</a>
<a class="sourceLine" id="cb6-22" title="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-23" title="23"><span class="co">#&gt; // linelist object</span></a>
<a class="sourceLine" id="cb6-24" title="24"><span class="co">#&gt; # A tibble: 188 × 12</span></a>
<a class="sourceLine" id="cb6-25" title="25"><span class="co">#&gt;    case_ID infector date_of_prodrome date_of_rash date_of_death   age gender</span></a>
<a class="sourceLine" id="cb6-26" title="26"><span class="co">#&gt;      &lt;int&gt;    &lt;int&gt; &lt;date&gt;           &lt;date&gt;       &lt;date&gt;        &lt;dbl&gt; &lt;fct&gt; </span></a>
<a class="sourceLine" id="cb6-27" title="27"><span class="co">#&gt;  1       1       45 1861-11-21       1861-11-25   NA                7 f     </span></a>
<a class="sourceLine" id="cb6-28" title="28"><span class="co">#&gt;  2       2       45 1861-11-23       1861-11-27   NA                6 f     </span></a>
<a class="sourceLine" id="cb6-29" title="29"><span class="co">#&gt;  3       3      172 1861-11-28       1861-12-02   NA                4 f     </span></a>
<a class="sourceLine" id="cb6-30" title="30"><span class="co">#&gt;  4       4      180 1861-11-27       1861-11-28   NA               13 m     </span></a>
<a class="sourceLine" id="cb6-31" title="31"><span class="co">#&gt;  5       5       45 1861-11-22       1861-11-27   NA                8 f     </span></a>
<a class="sourceLine" id="cb6-32" title="32"><span class="co">#&gt;  6       6      180 1861-11-26       1861-11-29   NA               12 m     </span></a>
<a class="sourceLine" id="cb6-33" title="33"><span class="co">#&gt;  7       7       42 1861-11-24       1861-11-28   NA                6 m     </span></a>
<a class="sourceLine" id="cb6-34" title="34"><span class="co">#&gt;  8       8       45 1861-11-21       1861-11-26   NA               10 m     </span></a>
<a class="sourceLine" id="cb6-35" title="35"><span class="co">#&gt;  9       9      182 1861-11-26       1861-11-30   NA               13 m     </span></a>
<a class="sourceLine" id="cb6-36" title="36"><span class="co">#&gt; 10      10       45 1861-11-21       1861-11-25   NA                7 f     </span></a>
<a class="sourceLine" id="cb6-37" title="37"><span class="co">#&gt; # … with 178 more rows, and 5 more variables: family_ID &lt;int&gt;, class &lt;fct&gt;,</span></a>
<a class="sourceLine" id="cb6-38" title="38"><span class="co">#&gt; #   complications &lt;fct&gt;, x_loc &lt;dbl&gt;, y_loc &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-39" title="39"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-40" title="40"><span class="co">#&gt; // tags: date_onset:date_of_prodrome, date_death:date_of_death, gender:gender, age:age</span></a></code></pre></div>
<p>The printing of the object confirms that the tags have been added. If we want to double-check which variables have been tagged:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">tags</span>(x)</a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">#&gt; $date_onset</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#&gt; [1] &quot;date_of_prodrome&quot;</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt; $date_death</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt; [1] &quot;date_of_death&quot;</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co">#&gt; $gender</span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">#&gt; [1] &quot;gender&quot;</span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co">#&gt; $age</span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co">#&gt; [1] &quot;age&quot;</span></a></code></pre></div>
</div>
<div id="changing-tags" class="section level2">
<h2>Changing tags</h2>
<p>Tags can be added / removed / changed using <code>set_tags()</code>.</p>
<p>Let us assume we also want to record the outcome: it is currently missing, but can be built from dates of deaths (missing date = survived). This can be done by using <code>mutate</code> on <code>x</code> to create the new variable (remember <code>x</code> is not only a <code>linelist</code>, but also a regular <code>tibble</code> and this compatible with <code>dplyr</code> verbs), and setting up a new tag using <code>set_tags</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"></a>
<a class="sourceLine" id="cb8-2" title="2">x &lt;-<span class="st"> </span>x <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">inferred_outcome =</span> <span class="kw">if_else</span>(<span class="kw">is.na</span>(date_of_death), <span class="st">&quot;survided&quot;</span>, <span class="st">&quot;died&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="st">  </span><span class="kw">set_tags</span>(<span class="dt">outcome =</span> <span class="st">&quot;inferred_outcome&quot;</span>)</a>
<a class="sourceLine" id="cb8-5" title="5">x</a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">#&gt; // linelist object</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">#&gt; # A tibble: 13 × 13</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#&gt;    case_ID infector date_of_prodrome date_of_rash date_of_death   age gender</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co">#&gt;      &lt;int&gt;    &lt;int&gt; &lt;date&gt;           &lt;date&gt;       &lt;date&gt;        &lt;dbl&gt; &lt;fct&gt; </span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">#&gt;  1       1       45 1861-11-21       1861-11-25   NA                7 f     </span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="co">#&gt;  2       2       45 1861-11-23       1861-11-27   NA                6 f     </span></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="co">#&gt;  3       3      172 1861-11-28       1861-12-02   NA                4 f     </span></a>
<a class="sourceLine" id="cb8-14" title="14"><span class="co">#&gt;  4       4      180 1861-11-27       1861-11-28   NA               13 m     </span></a>
<a class="sourceLine" id="cb8-15" title="15"><span class="co">#&gt;  5       5       45 1861-11-22       1861-11-27   NA                8 f     </span></a>
<a class="sourceLine" id="cb8-16" title="16"><span class="co">#&gt;  6       6      180 1861-11-26       1861-11-29   NA               12 m     </span></a>
<a class="sourceLine" id="cb8-17" title="17"><span class="co">#&gt;  7       7       42 1861-11-24       1861-11-28   NA                6 m     </span></a>
<a class="sourceLine" id="cb8-18" title="18"><span class="co">#&gt;  8       8       45 1861-11-21       1861-11-26   NA               10 m     </span></a>
<a class="sourceLine" id="cb8-19" title="19"><span class="co">#&gt;  9       9      182 1861-11-26       1861-11-30   NA               13 m     </span></a>
<a class="sourceLine" id="cb8-20" title="20"><span class="co">#&gt; 10      10       45 1861-11-21       1861-11-25   NA                7 f     </span></a>
<a class="sourceLine" id="cb8-21" title="21"><span class="co">#&gt; 11      11      182 1861-11-25       1861-11-30   NA               11 f     </span></a>
<a class="sourceLine" id="cb8-22" title="22"><span class="co">#&gt; 12      12       45 1861-11-20       1861-11-25   NA                7 f     </span></a>
<a class="sourceLine" id="cb8-23" title="23"><span class="co">#&gt; 13      13       12 1861-11-30       1861-12-05   NA               13 m     </span></a>
<a class="sourceLine" id="cb8-24" title="24"><span class="co">#&gt; # … with 6 more variables: family_ID &lt;int&gt;, class &lt;fct&gt;, complications &lt;fct&gt;,</span></a>
<a class="sourceLine" id="cb8-25" title="25"><span class="co">#&gt; #   x_loc &lt;dbl&gt;, y_loc &lt;dbl&gt;, inferred_outcome &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb8-26" title="26"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-27" title="27"><span class="co">#&gt; // tags: date_onset:date_of_prodrome, date_death:date_of_death, gender:gender, age:age, outcome:inferred_outcome</span></a></code></pre></div>
<p>If we wanted to undo the above, i.e. remove the <code>outcome</code> tag, we only need set it to <code>NULL</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"></a>
<a class="sourceLine" id="cb9-2" title="2">x &lt;-<span class="st"> </span>x <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="st">  </span><span class="kw">set_tags</span>(<span class="dt">outcome =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb9-4" title="4"><span class="kw">tags</span>(x)</a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co">#&gt; $date_onset</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="co">#&gt; [1] &quot;date_of_prodrome&quot;</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co">#&gt; $date_death</span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co">#&gt; [1] &quot;date_of_death&quot;</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="co">#&gt; $gender</span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co">#&gt; [1] &quot;gender&quot;</span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-14" title="14"><span class="co">#&gt; $age</span></a>
<a class="sourceLine" id="cb9-15" title="15"><span class="co">#&gt; [1] &quot;age&quot;</span></a></code></pre></div>
</div>
<div id="accessing-tagged-variables" class="section level2">
<h2>Accessing tagged variables</h2>
<p>Now that key variables have been tagged in <code>x</code>, we can used these pre-defined fields in downstream analyses, without having to worry about variable names and types. We could access tagged variables using any of the following means:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co"># select tagged variables only</span></a>
<a class="sourceLine" id="cb10-3" title="3">x <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="st">  </span><span class="kw">select_tags</span>(date_onset, date_death)</a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co">#&gt; # A tibble: 13 × 2</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">#&gt;    date_onset date_death</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#&gt;    &lt;date&gt;     &lt;date&gt;    </span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">#&gt;  1 1861-11-21 NA        </span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co">#&gt;  2 1861-11-23 NA        </span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="co">#&gt;  3 1861-11-28 NA        </span></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="co">#&gt;  4 1861-11-27 NA        </span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="co">#&gt;  5 1861-11-22 NA        </span></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="co">#&gt;  6 1861-11-26 NA        </span></a>
<a class="sourceLine" id="cb10-14" title="14"><span class="co">#&gt;  7 1861-11-24 NA        </span></a>
<a class="sourceLine" id="cb10-15" title="15"><span class="co">#&gt;  8 1861-11-21 NA        </span></a>
<a class="sourceLine" id="cb10-16" title="16"><span class="co">#&gt;  9 1861-11-26 NA        </span></a>
<a class="sourceLine" id="cb10-17" title="17"><span class="co">#&gt; 10 1861-11-21 NA        </span></a>
<a class="sourceLine" id="cb10-18" title="18"><span class="co">#&gt; 11 1861-11-25 NA        </span></a>
<a class="sourceLine" id="cb10-19" title="19"><span class="co">#&gt; 12 1861-11-20 NA        </span></a>
<a class="sourceLine" id="cb10-20" title="20"><span class="co">#&gt; 13 1861-11-30 NA</span></a>
<a class="sourceLine" id="cb10-21" title="21"></a>
<a class="sourceLine" id="cb10-22" title="22"><span class="co"># select tagged variables only with renaming on the fly</span></a>
<a class="sourceLine" id="cb10-23" title="23">x <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-24" title="24"><span class="st">  </span><span class="kw">select_tags</span>(<span class="dt">onset =</span> date_onset, date_death)</a>
<a class="sourceLine" id="cb10-25" title="25"><span class="co">#&gt; # A tibble: 13 × 2</span></a>
<a class="sourceLine" id="cb10-26" title="26"><span class="co">#&gt;    onset      date_death</span></a>
<a class="sourceLine" id="cb10-27" title="27"><span class="co">#&gt;    &lt;date&gt;     &lt;date&gt;    </span></a>
<a class="sourceLine" id="cb10-28" title="28"><span class="co">#&gt;  1 1861-11-21 NA        </span></a>
<a class="sourceLine" id="cb10-29" title="29"><span class="co">#&gt;  2 1861-11-23 NA        </span></a>
<a class="sourceLine" id="cb10-30" title="30"><span class="co">#&gt;  3 1861-11-28 NA        </span></a>
<a class="sourceLine" id="cb10-31" title="31"><span class="co">#&gt;  4 1861-11-27 NA        </span></a>
<a class="sourceLine" id="cb10-32" title="32"><span class="co">#&gt;  5 1861-11-22 NA        </span></a>
<a class="sourceLine" id="cb10-33" title="33"><span class="co">#&gt;  6 1861-11-26 NA        </span></a>
<a class="sourceLine" id="cb10-34" title="34"><span class="co">#&gt;  7 1861-11-24 NA        </span></a>
<a class="sourceLine" id="cb10-35" title="35"><span class="co">#&gt;  8 1861-11-21 NA        </span></a>
<a class="sourceLine" id="cb10-36" title="36"><span class="co">#&gt;  9 1861-11-26 NA        </span></a>
<a class="sourceLine" id="cb10-37" title="37"><span class="co">#&gt; 10 1861-11-21 NA        </span></a>
<a class="sourceLine" id="cb10-38" title="38"><span class="co">#&gt; 11 1861-11-25 NA        </span></a>
<a class="sourceLine" id="cb10-39" title="39"><span class="co">#&gt; 12 1861-11-20 NA        </span></a>
<a class="sourceLine" id="cb10-40" title="40"><span class="co">#&gt; 13 1861-11-30 NA</span></a>
<a class="sourceLine" id="cb10-41" title="41"></a>
<a class="sourceLine" id="cb10-42" title="42"><span class="co"># get all tagged variables in a data.frame</span></a>
<a class="sourceLine" id="cb10-43" title="43">x <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-44" title="44"><span class="st">  </span><span class="kw">tags_df</span>()</a>
<a class="sourceLine" id="cb10-45" title="45"><span class="co">#&gt; # A tibble: 13 × 4</span></a>
<a class="sourceLine" id="cb10-46" title="46"><span class="co">#&gt;    date_onset date_death gender   age</span></a>
<a class="sourceLine" id="cb10-47" title="47"><span class="co">#&gt;    &lt;date&gt;     &lt;date&gt;     &lt;fct&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb10-48" title="48"><span class="co">#&gt;  1 1861-11-21 NA         f          7</span></a>
<a class="sourceLine" id="cb10-49" title="49"><span class="co">#&gt;  2 1861-11-23 NA         f          6</span></a>
<a class="sourceLine" id="cb10-50" title="50"><span class="co">#&gt;  3 1861-11-28 NA         f          4</span></a>
<a class="sourceLine" id="cb10-51" title="51"><span class="co">#&gt;  4 1861-11-27 NA         m         13</span></a>
<a class="sourceLine" id="cb10-52" title="52"><span class="co">#&gt;  5 1861-11-22 NA         f          8</span></a>
<a class="sourceLine" id="cb10-53" title="53"><span class="co">#&gt;  6 1861-11-26 NA         m         12</span></a>
<a class="sourceLine" id="cb10-54" title="54"><span class="co">#&gt;  7 1861-11-24 NA         m          6</span></a>
<a class="sourceLine" id="cb10-55" title="55"><span class="co">#&gt;  8 1861-11-21 NA         m         10</span></a>
<a class="sourceLine" id="cb10-56" title="56"><span class="co">#&gt;  9 1861-11-26 NA         m         13</span></a>
<a class="sourceLine" id="cb10-57" title="57"><span class="co">#&gt; 10 1861-11-21 NA         f          7</span></a>
<a class="sourceLine" id="cb10-58" title="58"><span class="co">#&gt; 11 1861-11-25 NA         f         11</span></a>
<a class="sourceLine" id="cb10-59" title="59"><span class="co">#&gt; 12 1861-11-20 NA         f          7</span></a>
<a class="sourceLine" id="cb10-60" title="60"><span class="co">#&gt; 13 1861-11-30 NA         m         13</span></a></code></pre></div>
</div>
<div id="using-safeguards" class="section level2">
<h2>Using safeguards</h2>
<p>Because <code>x</code> remains a valid <code>tibble</code>, we can use any data handling operations implemented in <code>dplyr</code>. However, some of these operations may cause accidental removal of key tagged variables. <em>linelist</em> provides a safeguard mechanism against this. For instance, let’s assume we want to select only some columns of <code>x</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="co"># hybrid selection</span></a>
<a class="sourceLine" id="cb11-3" title="3">x <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="st">  </span><span class="kw">select</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb11-5" title="5"><span class="co">#&gt; Warning in prune_tags(out, lost_action): The following tags have lost their variable:</span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co">#&gt;  date_onset:date_of_prodrome, date_death:date_of_death, gender:gender, age:age</span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="co">#&gt; // linelist object</span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="co">#&gt; # A tibble: 13 × 2</span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="co">#&gt;    case_ID infector</span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="co">#&gt;      &lt;int&gt;    &lt;int&gt;</span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="co">#&gt;  1       1       45</span></a>
<a class="sourceLine" id="cb11-13" title="13"><span class="co">#&gt;  2       2       45</span></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="co">#&gt;  3       3      172</span></a>
<a class="sourceLine" id="cb11-15" title="15"><span class="co">#&gt;  4       4      180</span></a>
<a class="sourceLine" id="cb11-16" title="16"><span class="co">#&gt;  5       5       45</span></a>
<a class="sourceLine" id="cb11-17" title="17"><span class="co">#&gt;  6       6      180</span></a>
<a class="sourceLine" id="cb11-18" title="18"><span class="co">#&gt;  7       7       42</span></a>
<a class="sourceLine" id="cb11-19" title="19"><span class="co">#&gt;  8       8       45</span></a>
<a class="sourceLine" id="cb11-20" title="20"><span class="co">#&gt;  9       9      182</span></a>
<a class="sourceLine" id="cb11-21" title="21"><span class="co">#&gt; 10      10       45</span></a>
<a class="sourceLine" id="cb11-22" title="22"><span class="co">#&gt; 11      11      182</span></a>
<a class="sourceLine" id="cb11-23" title="23"><span class="co">#&gt; 12      12       45</span></a>
<a class="sourceLine" id="cb11-24" title="24"><span class="co">#&gt; 13      13       12</span></a>
<a class="sourceLine" id="cb11-25" title="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-26" title="26"><span class="co">#&gt; // tags: [no tagged variable]</span></a></code></pre></div>
<p>Here, the above command gave a meaningful warning, in which <code>select</code> removes some of the variables that were tagged. This is because <em>linelist</em> implements a specific <code>select</code> method for <code>linelist</code> objects - see <a href="https://epiverse-trace.github.io/linelist/reference/select.linelist.html"><code>?select.linelist</code></a>. In fact, looking at the documentation, we can see that <code>select()</code> can be used to select variables both from the dataset and from the tags, using the <code>tags = ...</code> argument. For instance, to retain the first 2 variables, and the <code>gender</code> tag:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co"># hybrid selection</span></a>
<a class="sourceLine" id="cb12-3" title="3">x <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="st">  </span><span class="kw">select</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">tags =</span> <span class="st">&quot;gender&quot;</span>)</a>
<a class="sourceLine" id="cb12-5" title="5"><span class="co">#&gt; Warning in prune_tags(out, lost_action): The following tags have lost their variable:</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="co">#&gt;  date_onset:date_of_prodrome, date_death:date_of_death, age:age</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="co">#&gt; // linelist object</span></a>
<a class="sourceLine" id="cb12-9" title="9"><span class="co">#&gt; # A tibble: 13 × 3</span></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="co">#&gt;    case_ID infector gender</span></a>
<a class="sourceLine" id="cb12-11" title="11"><span class="co">#&gt;      &lt;int&gt;    &lt;int&gt; &lt;fct&gt; </span></a>
<a class="sourceLine" id="cb12-12" title="12"><span class="co">#&gt;  1       1       45 f     </span></a>
<a class="sourceLine" id="cb12-13" title="13"><span class="co">#&gt;  2       2       45 f     </span></a>
<a class="sourceLine" id="cb12-14" title="14"><span class="co">#&gt;  3       3      172 f     </span></a>
<a class="sourceLine" id="cb12-15" title="15"><span class="co">#&gt;  4       4      180 m     </span></a>
<a class="sourceLine" id="cb12-16" title="16"><span class="co">#&gt;  5       5       45 f     </span></a>
<a class="sourceLine" id="cb12-17" title="17"><span class="co">#&gt;  6       6      180 m     </span></a>
<a class="sourceLine" id="cb12-18" title="18"><span class="co">#&gt;  7       7       42 m     </span></a>
<a class="sourceLine" id="cb12-19" title="19"><span class="co">#&gt;  8       8       45 m     </span></a>
<a class="sourceLine" id="cb12-20" title="20"><span class="co">#&gt;  9       9      182 m     </span></a>
<a class="sourceLine" id="cb12-21" title="21"><span class="co">#&gt; 10      10       45 f     </span></a>
<a class="sourceLine" id="cb12-22" title="22"><span class="co">#&gt; 11      11      182 f     </span></a>
<a class="sourceLine" id="cb12-23" title="23"><span class="co">#&gt; 12      12       45 f     </span></a>
<a class="sourceLine" id="cb12-24" title="24"><span class="co">#&gt; 13      13       12 m     </span></a>
<a class="sourceLine" id="cb12-25" title="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb12-26" title="26"><span class="co">#&gt; // tags: gender:gender</span></a></code></pre></div>
<p>Again, we observe a warning as before due to the loss of tagged variables in the operation. This behaviour can be silenced if needed, or could be changed to issue an error (for stronger pipelines for instance):</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># hybrid selection</span></a>
<a class="sourceLine" id="cb13-2" title="2">x <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="st">  </span><span class="kw">select</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">tags =</span> <span class="st">&quot;gender&quot;</span>)</a>
<a class="sourceLine" id="cb13-4" title="4"><span class="co">#&gt; Warning in prune_tags(out, lost_action): The following tags have lost their variable:</span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="co">#&gt;  date_onset:date_of_prodrome, date_death:date_of_death, age:age</span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="co">#&gt; // linelist object</span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="co">#&gt; # A tibble: 13 × 3</span></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="co">#&gt;    case_ID infector gender</span></a>
<a class="sourceLine" id="cb13-10" title="10"><span class="co">#&gt;      &lt;int&gt;    &lt;int&gt; &lt;fct&gt; </span></a>
<a class="sourceLine" id="cb13-11" title="11"><span class="co">#&gt;  1       1       45 f     </span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="co">#&gt;  2       2       45 f     </span></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="co">#&gt;  3       3      172 f     </span></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="co">#&gt;  4       4      180 m     </span></a>
<a class="sourceLine" id="cb13-15" title="15"><span class="co">#&gt;  5       5       45 f     </span></a>
<a class="sourceLine" id="cb13-16" title="16"><span class="co">#&gt;  6       6      180 m     </span></a>
<a class="sourceLine" id="cb13-17" title="17"><span class="co">#&gt;  7       7       42 m     </span></a>
<a class="sourceLine" id="cb13-18" title="18"><span class="co">#&gt;  8       8       45 m     </span></a>
<a class="sourceLine" id="cb13-19" title="19"><span class="co">#&gt;  9       9      182 m     </span></a>
<a class="sourceLine" id="cb13-20" title="20"><span class="co">#&gt; 10      10       45 f     </span></a>
<a class="sourceLine" id="cb13-21" title="21"><span class="co">#&gt; 11      11      182 f     </span></a>
<a class="sourceLine" id="cb13-22" title="22"><span class="co">#&gt; 12      12       45 f     </span></a>
<a class="sourceLine" id="cb13-23" title="23"><span class="co">#&gt; 13      13       12 m     </span></a>
<a class="sourceLine" id="cb13-24" title="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-25" title="25"><span class="co">#&gt; // tags: gender:gender</span></a>
<a class="sourceLine" id="cb13-26" title="26"></a>
<a class="sourceLine" id="cb13-27" title="27"><span class="co"># hybrid selection - no warning</span></a>
<a class="sourceLine" id="cb13-28" title="28">x <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-29" title="29"><span class="st">  </span><span class="kw">lost_tags_action</span>(<span class="st">&quot;none&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-30" title="30"><span class="st">  </span><span class="kw">select</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">tags =</span> <span class="st">&quot;gender&quot;</span>)</a>
<a class="sourceLine" id="cb13-31" title="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-32" title="32"><span class="co">#&gt; // linelist object</span></a>
<a class="sourceLine" id="cb13-33" title="33"><span class="co">#&gt; # A tibble: 13 × 3</span></a>
<a class="sourceLine" id="cb13-34" title="34"><span class="co">#&gt;    case_ID infector gender</span></a>
<a class="sourceLine" id="cb13-35" title="35"><span class="co">#&gt;      &lt;int&gt;    &lt;int&gt; &lt;fct&gt; </span></a>
<a class="sourceLine" id="cb13-36" title="36"><span class="co">#&gt;  1       1       45 f     </span></a>
<a class="sourceLine" id="cb13-37" title="37"><span class="co">#&gt;  2       2       45 f     </span></a>
<a class="sourceLine" id="cb13-38" title="38"><span class="co">#&gt;  3       3      172 f     </span></a>
<a class="sourceLine" id="cb13-39" title="39"><span class="co">#&gt;  4       4      180 m     </span></a>
<a class="sourceLine" id="cb13-40" title="40"><span class="co">#&gt;  5       5       45 f     </span></a>
<a class="sourceLine" id="cb13-41" title="41"><span class="co">#&gt;  6       6      180 m     </span></a>
<a class="sourceLine" id="cb13-42" title="42"><span class="co">#&gt;  7       7       42 m     </span></a>
<a class="sourceLine" id="cb13-43" title="43"><span class="co">#&gt;  8       8       45 m     </span></a>
<a class="sourceLine" id="cb13-44" title="44"><span class="co">#&gt;  9       9      182 m     </span></a>
<a class="sourceLine" id="cb13-45" title="45"><span class="co">#&gt; 10      10       45 f     </span></a>
<a class="sourceLine" id="cb13-46" title="46"><span class="co">#&gt; 11      11      182 f     </span></a>
<a class="sourceLine" id="cb13-47" title="47"><span class="co">#&gt; 12      12       45 f     </span></a>
<a class="sourceLine" id="cb13-48" title="48"><span class="co">#&gt; 13      13       12 m     </span></a>
<a class="sourceLine" id="cb13-49" title="49"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-50" title="50"><span class="co">#&gt; // tags: gender:gender</span></a>
<a class="sourceLine" id="cb13-51" title="51"></a>
<a class="sourceLine" id="cb13-52" title="52"><span class="co"># hybrid selection - error due to lost tags</span></a>
<a class="sourceLine" id="cb13-53" title="53">x <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-54" title="54"><span class="st">  </span><span class="kw">lost_tags_action</span>(<span class="st">&quot;error&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-55" title="55"><span class="st">  </span><span class="kw">select</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">tags =</span> <span class="st">&quot;gender&quot;</span>)</a>
<a class="sourceLine" id="cb13-56" title="56"><span class="co">#&gt; Error in prune_tags(out, lost_action): The following tags have lost their variable:</span></a>
<a class="sourceLine" id="cb13-57" title="57"><span class="co">#&gt;  date_onset:date_of_prodrome, date_death:date_of_death, age:age</span></a>
<a class="sourceLine" id="cb13-58" title="58"></a>
<a class="sourceLine" id="cb13-59" title="59"><span class="co"># note that `lost_tags_action` sets the behavior for any later operation, so we </span></a>
<a class="sourceLine" id="cb13-60" title="60"><span class="co"># need to reset the default</span></a>
<a class="sourceLine" id="cb13-61" title="61"><span class="kw">get_lost_tags_action</span>() <span class="co"># check current behaviour</span></a>
<a class="sourceLine" id="cb13-62" title="62"><span class="co">#&gt; [1] &quot;error&quot;</span></a>
<a class="sourceLine" id="cb13-63" title="63"><span class="kw">lost_tags_action</span>() <span class="co"># reset default</span></a>
<a class="sourceLine" id="cb13-64" title="64"><span class="co">#&gt; Lost tags will now issue a warning.</span></a></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
